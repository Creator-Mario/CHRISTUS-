name: Release HTML App

# Runs on every push that touches the standalone HTML or its generators.
# Creates / updates the GitHub Release "html-latest" with BDE-Bibel.html attached.
# This workflow needs NO Flutter / Java â†’ completes in ~30 seconds.

on:
  push:
    branches:
      - main    # Only on main (human-merged) to avoid action_required blocks
    paths:
      - 'preview/standalone.html'
      - 'tools/build_standalone_preview.py'
      - 'tools/generate_passages_json.py'
      - 'elberfelder_1905.csv'
      - '.github/workflows/release-html.yml'
  workflow_dispatch:   # Manual trigger from any branch

permissions:
  contents: write   # Needed to create GitHub Releases

jobs:
  release-html:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # The standalone.html is pre-built and committed; just rename it.
      - name: Prepare download file
        run: cp preview/standalone.html BDE-Bibel.html

      - name: Create / update GitHub Release with HTML file
        uses: softprops/action-gh-release@v2
        with:
          tag_name: html-latest
          name: "BDE Bibel â€“ HTML App (alle GerÃ¤te)"
          body: |
            ## ğŸ“– BDE Bibel â€“ Offline HTML-App

            ### â¬‡ï¸ So herunterladen und nutzen

            **Schritt 1:** Auf **[BDE-Bibel.html](https://github.com/Creator-Mario/CHRISTUS-/releases/download/html-latest/BDE-Bibel.html)** klicken â†’ Datei wird heruntergeladen

            **Schritt 2 â€“ Android:**
            - Datei-App â†’ Downloads â†’ **BDE-Bibel.html** antippen â†’ Ã¶ffnet in Chrome
            - MenÃ¼ â‹® â†’ **â€Zum Startbildschirm hinzufÃ¼gen"** â†’ App-Symbol âœ…

            **Schritt 2 â€“ iPhone:**
            - Datei in **Safari** Ã¶ffnen
            - Teilen-Symbol â†‘ â†’ **â€Zum Home-Bildschirm"** â†’ HinzufÃ¼gen âœ…

            **Schritt 2 â€“ Windows / Mac:**
            - Doppelklick auf `BDE-Bibel.html` â†’ Ã¶ffnet im Browser
            - Lesezeichen setzen oder direkt nutzen âœ…

            ### Inhalt
            - ğŸ“– Elberfelder 1905 (Public Domain) â€“ 66 BÃ¼cher Â· 31 102 Verse
            - ğŸ¯ 359 kuratierte Bibelstellen in 18 Themen
            - ğŸ” Volltext-Suche (FTS5)
            - ğŸ“µ **Komplett offline** â€“ kein Internet nÃ¶tig nach dem Download
            - ğŸ“ ~2 MB â€“ eine einzige HTML-Datei

            ---
            *Creator & Copyright: Mario Reiner Denzer Â· Â© 2025 Â· Version 1.0.0*
          files: BDE-Bibel.html
          make_latest: true
          draft: false
          prerelease: false
